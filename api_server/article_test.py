import requests
import json
from typing import Optional, Dict, Any
from requests.exceptions import RequestException, Timeout, ConnectionError


class ArticleFeatureClient:
    """文章思维链提取服务的调用客户端"""
    
    def __init__(self, base_url: str = "http://localhost:8002"):
        """
        初始化客户端
        :param base_url: 服务基础地址（默认：本地8002端口，与服务配置一致）
        """
        self.base_url = base_url.rstrip("/")  # 确保地址末尾无斜杠
        self.headers = {"Content-Type": "application/json"}  # 请求头（JSON格式）
        self.timeout = 300000  # 请求超时时间（单位：秒，可根据文本长度调整）


    def extract_style(self, article_text: str) -> Dict[str, Any]:
        """
        调用文风特征提取接口（/extract-style）
        :param article_text: 待分析的文章文本（非空）
        :return: 提取结果（含ret_code、msg、style_summary、CoT等字段）
        :raises ValueError: 输入文本为空时抛出
        :raises RequestException: 网络请求异常时抛出
        """
        # 1. 校验输入（避免空文本请求）
        if not article_text.strip():
            raise ValueError("输入文本不能为空，请提供有效的文章内容")
        
        # 2. 构造请求参数
        url = f"{self.base_url}/extract-style"
        payload = {"text": article_text.strip()}  # 去除文本前后空白
        
        try:
            # 3. 发送POST请求
            response = requests.post(
                url=url,
                headers=self.headers,
                data=json.dumps(payload),  # 转为JSON字符串（避免requests自动编码问题）
                timeout=self.timeout
            )
            response.raise_for_status()  # 捕获HTTP错误（如404、500）
            result = response.json()
            
            # 4. 解析服务返回的状态（非0表示失败）
            if result.get("ret_code") != 0:
                raise RequestException(f"服务处理失败：{result.get('msg', '未知错误')}")
            
            return result
        
        except ConnectionError:
            raise RequestException(f"特征提取失败：无法连接服务（{url}），请确认服务已启动")
        except Timeout:
            raise RequestException(f"特征提取失败：请求超时（文本过长时可适当延长timeout）")
        except RequestException as e:
            raise RequestException(f"特征提取异常：{str(e)}")


# ------------------- 示例：如何使用客户端 -------------------
if __name__ == "__main__":
    # 1. 初始化客户端（默认连接本地8002端口，若服务部署在其他机器，需修改base_url）
    client = ArticleFeatureClient(base_url="http://localhost:7002")

    try:

        # 3. 准备测试文章文本（可替换为实际需要分析的文本）
        test_article = """
        全新4.0「幽靈奇妙夜」主題版本將於9月4日進行不停服更新，預計更新完成時間為9月4日11:00（UTC+0），屆時所有玩家將可更新至新版本，期間可以正常遊玩。最終更新完成時間可能根據實際情況而有所調整，如有變動將及時公告。

        【版本亮點】4.0版本以幽靈為主題，帶來全新競技模式與超多IP聯乘內容，為你呈現年度最瘋狂搞怪的奇幻體驗！具體聯乘內容之後將陸續揭曉，敬請持續留意。這次更新包括多重精彩內容：新武器迫擊炮、王牌段位獎勵升級、全新不對稱競技模式、Metro Royale 1v1單人模式、WOW 1.0全新升級；全面開放超流暢畫質選項，精準解決幀率、延遲等痛點。驚喜升級，挑戰不斷，盡在4.0版本！

        【更新獎勵】在9月10日（UTC+0）前完成更新，將透過電郵發放3,000 BP+100 AG；此外，4.0版本起更新福利全面升級——更新後免費贈送萬聖前夕主題大廳（版本全期間可用，更新後自動獲得）

        **【全新主題玩法：幽靈奇妙夜】**

        *神秘鬧鬼莊園中潛藏着各種奇幻幽靈夥伴，等你來召喚！所有幽靈夥伴均有獨特技能，為戰鬥注入搞怪樂趣，徹底告別單調！死亡後可解鎖其他的幽靈技能，繼續與隊友一同作戰——死亡不是終點，戰鬥永不停歇！快來探索幽靈的特殊能力吧！*

        ![](https://cdn-pubgm-cms.vasdgame.com/vasd-cms-pubgm/01_09aa6e5767.png)

        ☆ 上線時間：3/9/2025 02:00:00-4/11/2025 20:59:59（UTC+0）

        ☆ 上線地圖：Erangel、Livik、Rondo（包括排位模式及配對模式）

        注意：Erangel和Livik地圖中將會推出所有內容，Rondo地圖僅推出主題玩法中的「小鬼頭幽靈、搗蛋鬼幽靈、飛天掃把」

        **玩法機制**

        **☆ 幽靈夥伴：小鬼頭**

        **◇ 玩法機制：**全程陪伴的生存階段幽靈夥伴，使用技能時他人才能看見，非使用狀態下僅自己可見。

        **- 如何獲得：**在局內可以拾取到各種小鬼頭可使用的技能道具，在背囊內將它們裝備至小鬼頭身上後，就可以使用對應技能。

        **- 技能種類：**可供拾取的技能有2個主動技能+5個被動技能，最多可以同時持有1個主動技能+2個被動技能。

        **- 技能升級：**每個技能有三個等級，地圖中有高級技能可直接拾取；也可透過拾取技能升級道具，升級低等級技能。

        **◇ 技能使用說明：**

        **- 飄浮氣球（主動）：**化身氣球將玩家拉起，吸氣上升後放氣飛行。

        **- 守護之盾（主動）：**化身巨盾附在主人身上，持盾衝撞可擊走敵人，亦可放下作為掩護物。

        **- 修理工（被動）：**護甲耐久度下降至一定程度時自動修復，技能等級越高修復越頻繁。

        **- 小鬼頭套（被動）：**主人原地待機過久或頭部受擊時，產生防護頭套，可抵銷部分傷害。頭套狀態下開咪聲音將變為尖銳快速或低沉冗長。

        **- 掃描（被動）：**獲得望遠鏡能力，命中敵人時觸發範圍偵測，標記附近敵對玩家位置。

        **- 助跑（被動）：**衝刺狀態下提供額外助推加速。

        **- 療癒（被動）：**生命值下降時自動治療，救援隊友時代為完成治療。

        **☆ 死亡幽靈：搗蛋鬼**

        **◇ 玩法機制：**玩家死亡後將化身為搗蛋鬼，擁有隨時間衰減的能量條（使用技能或受到攻擊時會額外消耗）。能量耗盡後徹底死亡並進入觀戰狀態，期間若被隊友復活則會提前終止搗蛋鬼形態。

        **◇ 技能使用說明：**

        **- 守護之盾：**化身為傷害吸收護盾（僅在受擊時消耗能量）。

        **- 掃描：**標記目標位置，使對方暴露給全體玩家（消耗能量）。

        **- 炸彈：**化身高速移動炸彈，爆炸造成範圍傷害與擊退（消耗能量）。

        **☆ 技能開放規劃：**小鬼頭和搗蛋鬼技能將於9月3日、11日、18日逐次推出，持續解鎖新體驗！

        ![](https://cdn-pubgm-cms.vasdgame.com/vasd-cms-pubgm/02_63bd022c52.png)

        **主題場景**

        **☆ 鬧鬼莊園：**神秘莊園坐落著宏偉洋樓，內藏蘊含神秘力量的珍奇收藏與陳設，外圍涵蓋植物園、迷宮、紀念區及種植區等多元探索區域。

        **◇ 幽靈特色玩法：**

        \- 魔鏡寶物:開啟封印魔鏡可獲得物資,並成為最強隊伍。

        \- 膽小幽靈:偽裝成場景物件出現於局內,可透過攻擊/射擊揭露真身並獲得掉落物資。

        \- 寶箱幽靈:開啟後會暴露周圍玩家的位置。

        \- 鬧鬼家具:懸浮狀態的神秘家具。

        **☆ 鬼哭魂嚎-搖滾音樂會：**

        ◇ 在開局一段時間後，地圖的特定區域將展開幽靈樂隊「鬼哭魂嚎」的搖滾音樂會。

        ◇ 進入音樂會區域會觸發演奏，演奏結束後可獲得對應物資獎勵。

        ◇ 演奏期間可與幽靈樂團互動，如果發現幽靈彈錯音符，並在身邊「提醒」他，可以加速獲得物資及額外獎勵。

        ◇ 互動玩家還能獲得幽靈警告，若有敵方玩家靠近，樂隊會提示大致方位。

        **主題道具**

        **☆ 飛天掃把：**具有魔法能量的雙人騎乘掃把，可自由召喚並靈活飛行，配備衝刺與大掃除雙技能。

        ◇ 衝刺：提升位移能力。

        ◇ 大掃除：透過儲力發動，可將面前敵人擊走。

        **【經典地圖更新】**

        ![](https://cdn-pubgm-cms.vasdgame.com/vasd-cms-pubgm/03_321e773f0d.png)

        **武器更新**

        **☆ 新武器：迫擊炮**

        ◇ 可單人攜帶的輕型迫擊炮（佔用手槍欄位），使用專屬高傷害彈藥。

        ◇ 需於地面部署後發射，支援視野內瞄準線速射/視野外地圖選點兩種攻擊模式。

        **☆ 槍械改良**

        ◇ 模擬真實換彈機制：適用於自動步槍/衝鋒槍/連發狙擊槍/部分手槍及單發狙擊槍，戰術換彈後保留槍膛子彈（待擊發數+1），更接近真實戰術換彈原理。

        ◇ 手槍動畫更新：優化空彈匣與換彈動作逼真度，換彈時間和手感不改變。

        ◇ 後坐力改善：調整垂直/水平後坐力計算機制，提升開火穩定度。

        **配件更新**

        **☆ 握把配件調整**

        ◇ 直角握把：略微增強水平後坐力控制。

        ◇ 半截式握把：略微增強開火視角穩定度。

        ◇ 輕型握把：移除垂直後坐力控制，新增開火視角穩定與槍械穩定度的特性。

        ◇ 人體工學握把：略微削弱水平/垂直後坐力控制，增加槍械開火穩定度與晃動控制特性。

        ◇ 雷射瞄準器：略為增強散射控制。

        ◇ 其他握把（垂直/拇指）：屬性保持不變。

        **☆ 槍托配件調整**

        ◇ 戰術槍托：降低後坐力控制，新增開火晃動控制特性。

        ◇ 托腮板：降低垂直後坐力與散射控制，增強開火視角穩定度，新增開火槍械穩定度特性。

        ◇ 重型槍托/Micro Uzl：屬性保持不變。

        **☆ 配件資訊調整**

        ◇ 改善握把/槍托配件在背囊的屬性說明展示

        **地圖更新**

        **☆ Erangel地圖Lipovka區域更新：**

        ◇ 在北側沙灘新增海濱樂園裡面鞦韆和摩天輪，可以在緊張的戰鬥之餘在此享受片刻的閒暇時光。

        **【Metro Royale更新】**

        ![](https://cdn-pubgm-cms.vasdgame.com/vasd-cms-pubgm/04_5268824a11.png)

        **賽季更新**

        ☆ 賽季時間：5/9/2025 02:00:00-4/11/2025 00:00:00（UTC+0）

        ☆ Chapter 28賽季開始，更新賽季收藏品。

        **模式更新**

        ☆ 新增1V1單人模式，可在組隊介面向隊友提出起單挑邀請。

        **系統更新**

        ☆ 戰備頁推薦戰備支援一鍵購買並穿著全套裝備。

        **地圖更新**

        ☆ 經典地圖中將隨機出現幽靈寶箱，開啟後有機率獲得高價值變賣物；特殊寶箱可獲得更豐富的物資獎勵。

        **【WOW更新】**

        ![](https://cdn-pubgm-cms.vasdgame.com/vasd-cms-pubgm/05_674bd4f361.png)

        **系統更新**

        **☆ 創造者權限大量開放：**按WOW玩家遊玩等級從高到低逐步開放創造者資格，釋放無限創意潛能，打造你的專屬奇妙世界！

        **☆ AI助手：**智能輔助創作，幫你解決作品編輯難題！向9級以上創造者逐步開放，目前支援部分語言。

        **☆ 優質留言推薦：**篩選WOW地圖留言區與俱樂部優秀內容推薦給創造者，不再錯過任何優質留言。

        **☆ 推薦演算法調整：**升級「猜你喜歡」推薦效果，新增多方位作品特徵。

        **☆ 配對調整：**提升上線人數精確度，改善配對時間預測。

        **☆ 新作分頁：**改善篩選機制，提升優秀新作曝光率。

        **☆ 作品大廳：**

        ◇ 新增開局前判斷流程，提升等待廳開局效率。

        ◇ 支援多作品大廳並行等待（WOW PASS玩家專屬）。

        **☆ 好友都在玩：**改善資訊展示，點擊「一起玩」顯示好友具體遊玩資訊，組隊遊玩更方便。

        **☆ 作品推廣卡：**新增遊廊場景展示。提升兌換中心推廣卡門檻，調整創作任務獎勵。

        **共贏生態**

        **☆ 全新WOW PASS登場，大量WOW模式專屬資源來襲**

        ◇ 維持時間：3/9/2025 07:00:00-4/11/2025 23:59:59（UTC+0）

        ◇ 免費參與，可透過完成任務獲得積分，提升WOW PASS等級，並獲得豐富對局道具獎勵。

        ◇ 升級PASS還可解鎖更多內容，同時支援花費UC購買積分加速升級。

        ◇ 重要提示：版本結束後未使用的PASS積分、積分卡及任務卡也將過期。

        **☆ WOW禮物**

        ◇ 持續時間：3/9/2025 00:00:00-4/11/2025 23:59:59（UTC+0）

        ◇ 新增WOW專屬禮物，創造者獲得後可累積創想值、提升賽季創想等級。

        ◇ 賽季創想等級可解鎖大量個人化外觀資源。

        ◇ 新增【創想值排行榜】活動，排名高的玩家可獲得高額現金獎勵。

        **☆ 個人化資源**

        ◇ 局外資源：新增入房通知、主頁裝飾。

        ◇ 局內資源：新增擊殺特效、復活特效。

        **編輯器更新**

        **☆ 視覺化程式設計：**

        **◇ 怪物與武裝AI預設：**

        \- 新增裝載程式碼功能,可為個別怪物或武裝AI裝載獨立程式碼並加以執行。

        \- 新增怪物指令相關區塊,支援動態指揮怪獸攻擊、移動或保衛目標、保衛區域。

        **◇ 新增怪物等級系統：**更新時根據預設等級自動初始化屬性值，提供官方範本方案與自訂方案雙選擇。

        **◇ 新增怪物訊息互動區塊：**新增取得怪物索敵目標、設定掉落方案、設定基礎屬性及監控生命值變化等區塊。

        **◇ 新增槍械功能區塊：**支援動態切換玩家手持武器、裝填彈藥及取得即時彈藥量等操作。

        **◇ 新增技能相關區塊：**新增針對技能實例的修改與屬性取得功能區塊。

        **◇ 新增發射體區塊：**支援修改已產生發射物體的爆炸傷害、命中傷害及爆炸範圍參數。

        **◇ 新增角色建立區塊：**新增即時建立怪物與武裝AI角色功能，條件滿足時立即產生角色並支援傳回實例進行後續處理。

        **◇ 區塊標記調整：**新增分頁小紅點提示，即時顯示目前分頁下未讀新區塊數量。

        **◇ 區域傷害判定調整：**改善區域傷害類區塊，現根據「角色是否在區域中」（而非角色模型中心）精準判定傷害目標。

        **☆ 資源植入：**

        **◇ 武器：**新增迫擊炮、法棍麵包、黃金平底鑊、螢光棒。

        **◇ 場景：**新增幽靈莊園場景物件及攝影機模型。

        **◇ 技能：**新增守護之盾和飄浮氣球幽靈技能。

        **◇ 載具：**新增AH6直升機、魔法掃把。

        **☆ 其他功能更新**

        **◇ 技能編輯器：**

        \- 新增技能組合功能,實現技能施放後自動切換至其他技能的連續技玩法。

        \- 支援特效預覽功能,可即時預覽技能特效表現。

        **◇ 預設管理：**

        \- 新增預設倉庫介面,支援統一管理怪物、加成、技能等遊戲元素。

        **◇ 數據結構性能偵測教學：**

        \- 頁面新增說明按鈕，點擊查看頁面影片教學（講解性能問題成因及解決方法）。

        **【基礎體驗改良】**

        **☆ 性能調整**

        **◇ 新增超流暢畫質選項：**有效改善幀率/延遲/耗電/發熱問題。

        **- 幀率調整：**部分機型最高可選幀率提升：中等（25 fps）→高清（30 fps）；高清（30 fps）→超高清（40 fps）；超高清（40 fps）→極致（50-60 fps）。

        **- 減少延遲：**使用超流暢畫質時，部分機型延遲減少30%至50%。

        **- 發熱改善：**超流暢畫質下部分機型連續兩局後，溫度降低2°C至4°C，發熱降頻減少15%。

        **- 耗電改善：**使用超流暢畫質時，CPU/GPU負載降低大約10%，整體功耗減少5%至7%。

        **◇ 兼容高幀率：**部分新機型新增支援90 fps及120 fps。

        ◇ 更多詳細內容請參考4.0版本更新調整公告。

        **☆ 載具系統調整**

        **◇ 騎射機制：**

        \- 修正騎馬開鏡瞄準時角色身體穿模問題。

        \- 兩輪載具騎射時速度穩定度提升。

        **◇ 備用車胎：**支援用於倒地的電單車。

        **◇ 水中表現：**

        \- 移除生物載具與游泳玩家的穿模現象。

        \- 船載具移動更平滑,減少抖動。

        **☆ 戰鬥操作調整**

        \- 搖桿機制：切換操作單位（如上車/變身）時保持移動方向，毋須重新操作搖桿。

        \- 準星系統:新增四倍鏡準星快速切換功能,開鏡後可自訂準星樣式並永久保留。

        **☆ 隊友合作調整**

        \- 新增正向行為鼓勵機制(大逃殺玩法):治療/救援/召回隊友可累積合作值,用於兌換包括戰鬥物資的合作補給箱,支援團隊合作玩家提升戰鬥力。

        **☆ 經典模式結算**

        ◇ MVP時刻

        \- 新增「MVP印記」:個人化資源,裝備後可以改變玩家的MVP時刻效果。

        \- 新增幽靈奇妙夜MVP動作:該動作擁有特殊的展示背景,並會影響最終的結算介面呈現。

        \- 獲取方式:以上新增資源可透過「經典賽季 - 榮譽之路」獲得,目前僅在經典模式對局中生效。

        ◇ 四人結算動作

        \- 新增「隊伍結算動作」:個人化資源,裝備後可以改變玩家在經典模式下隊伍結算時的個人動作。

        \- 設定方式:可透過「經典賽季 - 榮譽之路」獲得,可設定跟隨時裝裝扮或跟隨物品設定。

        **☆ 自訂開局動畫**

        ◇ 新增「開局動畫」：個人化資源，裝備後可以改變各模式下進入對局前的動畫效果。

        ◇ 獲取方式：該資源同樣可透過「經典賽季 - 榮譽之路」獲得。

        **【賽季更新】**

        **CYCLE 9 SEASON 26經典賽季**

        ☆ 開放時間：11/9/2025 02:00:00-10/11/2025 23:59:59（UTC+0）

        ☆ 賽季獎勵：加入粉色品質系列道具（C9S26-賽季眼鏡/套裝/面具/頭飾/DBS）。

        ☆ 賽季幣商店：新增C9S26-降落傘兌換。

        ☆ 段位體系：

        ◇ 新增經典/休閒雙賽季段位獎勵。

        ◇ 超級王牌以上開放榮譽之路，解鎖專屬榮譽資源。

        ◇ 調整段位目標系統（達成前賽季最高段位獲額外獎勵）。

        ◇ 調整段位商店顯示位置。

        ☆ 賽季活動：

        ◇ 主題玩法不掉分：3/9/2025 02:00:00-21/9/2025 23:59:59（UTC+0）

        ◇ 賽季末排位加分： 21/10/2025 02:00:00-10/11/2025 23:59:59（UTC+0）

        **CYCLE 9 SEASON 26休閒賽季**

        ☆ 開放時間：11/9/2025 02:00:00-10/11/2025 23:59:59（UTC+0）

        ☆ 核心玩法：完成每週任務取得休閒積分，提升段位並領取達成獎勵（部分獎勵雙賽季通用，首次解鎖為物品，重複獲得轉為賽季幣）。

        ☆ 段位設定：青銅/白銀/黃金/鉑金/星鑽/皇冠/王牌（共7級）。

        ☆ 雙賽季獎勵：同步開放經典/休閒賽季段位獎勵。

        ☆ 積分調整：調整各段位所需休閒積分數量。

        ☆ 段位繼承：C9S26賽季開啟時按目前段位繼承對應休閒積分。

        **CYCLE 9 SEASON 26巔峰賽**

        ☆ 開放時間：11/9/2025 00:00:00-10/11/2025 23:59:59（UTC+0）

        ☆ 參賽門檻：過往賽季所有模式最高段位達皇冠以上。

        ☆ 地圖機制：Sanhok地圖結算積分按0.5系數縮放。

        ☆ 特色活動：

        ◇ Miramar/Sanhok地圖賽季頭三局額外+10分（22/9/2025 02:00:00-4/11/2025 23:59:59（UTC+0））

        ◇ 巔峰賽賽季初每日首2局不掉分（22/9/2025 02:00:00-4/11/2025 23:59:59（UTC+0））

        **槍械戰鬥力**

        ☆ 開放時間：11/9/2025 02:00:00-10/11/2025 23:59:59（UTC+0）

        ☆ 核心定義：衡量玩家在經典排位/巔峰賽中使用槍械的精通程度。

        ☆ 計算根據：綜合每分鐘傷害量、擊殺人數、命中率、槍械攜帶時間等對局表現。

        ☆ 段位綁定：戰鬥力上限隨段位提升逐步提高，部分等級需要達成經典賽季/巔峰賽段位才能解鎖。

        ☆ 重設規則：每賽季結束後戰鬥力值歸零。

        ☆ 排行榜機制：每月1日0時進行排行榜結算，頭100名獲得30天限時稱號（賽季末不發獎，僅展示排行榜分數，新賽季開啟後重設）。

        ☆ 其他規則：

        ◇ 單一地區限制：無法多區同時上榜。

        ◇ 榮譽展示：資料-榮譽介面預設顯示各槍械最高等級紀錄。

        ◇ 空窗期限制：賽季空窗期對局不新增段位分與槍械戰鬥力。

        **瘋狂週末活動**

        ☆ 瘋狂福利：組隊暢享對局特權與大量獎勵！

        ☆ 瘋狂衝分：好友組隊排位享多重福利

        ◇ 組隊排位不掉分、組隊排位額外加分、組隊挑戰值雙倍、組隊排位不限段。

        ☆ 瘋狂收益：任何模式組隊加成翻倍

        ◇ 人氣值雙倍、親密度雙倍、經驗值雙倍。

        ☆ 隨意開局：完成任何模式組隊2局即享

        ◇ 現金抽獎機會、3天槍械體驗卡。

        ☆ 幸運雞友：每週從完成組隊任務的玩家中抽取現金大獎。

        ☆ 活動開放時間：以下時區均為UTC+0，對應日期的00:00-23:59全天開放。

        ◇ 中東/東歐/南亞/非洲地區，逢週五開放：9月12日/9月19日/9月26日/10月3日/10月10日/10月17日/10月24日/10月31日。

        ◇ 東南亞/北美/拉丁美洲地區，逢週六開放：9月13日/9月20日/9月27日/10月4日/10月11日/10月18日/10月25日/11月1日。

        ◇ 西歐地區，逢週日開啟：9月14日/9月21日/9月25日/10月5日/10月12日/10月19日/10月26日/11月2日。

        **【HUB更新】**

        **☆ 基礎體驗調整：**

        ◇ 改善Hub到期後的移動體驗。

        ◇ 改善Hub中玩家狀態的顯示。

        ◇ 改善改色外觀在Hub中的表現。

        ◇ 改善WOW模式在Hub中的下載提示。

        ◇ 改善雙人互動動作表現。

        ◇ 改善可互動物件的表現和體驗。

        **【團隊競技更新】**

        **排位賽更新**

        **☆ 活動更新**

        ◇ 活動時間： 16/9/2025 02:00:00-21/10/2025 23:59:59（UTC+0）

        ◇ 玩法入口：排位模式新增「競技場」分頁入口，也可透過配對-競技場分頁下方前往進入。

        ◇ 玩法模式：隨機配對4大競技場排位模式（死亡競技排位-倉庫/機庫、衝鋒競技排位-遺跡、佔點競技排位-小鎮）。

        ◇ 玩法獎勵：段位即時獎勵+全區頭1,000名限定稱號，榮譽與實力並存。

        **☆ 玩法調整**

        ◇ 復活機制：遺跡地圖改為跟隨隊友復活。

        ◇ 功能禁用：競技場排位賽禁用滑鏟功能。

        **☆ 配對與選擇模式**

        ◇ 玩法入口：競技場排位賽開啟時，競技場分頁下會出現排位賽入口直達排位頁面。

        ◇ 機率調整：微調競技場排位賽地圖庫各模式隨機配對機率。

        ◇ 配對限制：僅隊伍成員全體下載競技場排位賽地圖後，即可開啟排位配對。

        **☆ 掛機與斷線處理**

        ◇ 重新連線調整：為斷線玩家提供更充裕的重新連線時間。

        ◇ 掛機懲罰：長時間無操作將觸發警告，持續逾時會判定掛機並扣除結算分數。隊友掛機導致失敗時，正常遊玩玩家的扣分將大幅降低，保護上分體驗。

        **槍械屬性調整**

        **☆ 調整部分槍械在競技場玩法中的屬性，包括死亡競技、競技場排位賽等模式（以下屬性調整僅在競技場模式中生效！）**

        ◇ P90衝鋒槍：命中身體傷害系數1.05 →1

        ◇ Vector衝鋒槍：基礎傷害30→31

        ◇ SCAR-L自動步槍：基礎傷害43→44

        ◇ M762自動步槍：基礎傷害46→47

        ◇ ACE32自動步槍：基礎傷害45→46

        ◇ FAMAS自動步槍：基礎傷害39→40

        ◇ SKS：軀幹部位傷害係數13→1.05（恢復經典模式數值）

        ◇ Mini14：軀幹部位傷害系數13-1.1（恢復經典模式數值）

        ◇ SLR：軀幹部位傷害系數1.3-1（恢復經典模式數值）

        ◇ QBU：軀幹部位傷害系數1.3-1（恢復經典模式數值）

        **【家園更新】**

        **功能調整**

        ☆ 載入功能調整：可更快速進入家園，減少等待時間。

        ☆ 等級權益提升：提升每個等級可用的結構物件與裝飾物件，進一步提升家園個人化建設的能力。

        ☆ 家園圖紙分期付款功能：購買家園圖紙時支援分期付款，具體規則如下：

        ◇ 付出一定比例首期款項後，每月償還剩餘金額。

        ◇ 透過活躍可免除全部利息，同一時間僅支援1個物品分期。

        ◇ 獲得相同圖紙可用於扣減未付的分期金額。

        **物品更新**

        **☆ 新增主題風格：月神城堡登場**

        ◇ 推出時間：12/9/2025 00:00:00（UTC+0）

        ◇ 新風格促銷：購買新風格物品可累積繁榮度積分，繁榮度達一定值可領取我們準備的豐富好禮。

        ◇ 新風格活動：

        \- 進入家園可以領取新風格物品禮包（禮包三選一）。

        \- 新增月神風格分排行榜,達到指定風格分或排名即可領取對應獎勵。

        ◇ 家園巧匠超值通：全新風格月神城堡巧匠超值通登場，加量不加價，獎勵道具升級，升級Elite版本可立刻獲得紅色品質家園裝飾物件！

        ◇ 家園輪盤&amp;商店：推出新風格月神城堡。

        **☆ 神秘商人寶箱：**新增新風格高品質物。

        **玩法更新**

        **☆ 家園停車場新賽季開啟：**

        ◇ 推出時間：12/9/2025 02:00:00（UTC+0）

        ◇ 可把倉庫中的載具造型加入至家園停車場，參與全新的車位佔領玩法賺取停車券。

        ◇ 可把載具停放在好友或其他玩家的停車場中，停放的載具品質越高、目標停車場等級越高，停車券收益越高。

        ◇ 其他玩家停泊在自己停車場的載具可能會帶來驚喜禮包。

        ◇ 停車券可在商店兌換載具代幣、抽獎減免券、家園限定雕像等豐富道具獎勵。

        ◇ 每週結算當週停車券收益排行榜，頭一百名玩家可透過電郵領取額外道具獎勵。

        ◇ 停車場玩法每個賽季結算，已獲得的停車場資源、停車場等級及商店獲取的道具獎勵將會保留，停車券將在賽季末清空並分解為家園幣。

        **家園建造大賽**

        **☆ 活動主題：發揮無限創意，營造夢想家園！**

        ◇ 募集期：6/9/2025 02:00:00-23/9/2025 08:59:59（UTC+0)

        ◇ 評選期：23/9/2025 09:00:00-23/10/2025 08:59:59（UTC+0)

        **☆ 參賽條件與報名規則**

        ◇ 報名基礎條件：如要報名參加家園建造大賽，家園繁榮度須≥200

        ◇ 補報機制：若錯過募集期，仍可在評選期內報名，報名後將進入下一輪配對池。

        ◇ 評選根據：成功報名後，系統將顯示目前家園的模型效果，作為之後評選的主要根據。

        **☆ 評選機制與對戰流程**

        ◇ 對決模式：在評選期內，玩家將每3天隨機配對一名繁榮度相若的對手，進行共10輪對決。

        ◇ 勝負判定：對決時，系統會比較雙方獲得的「家園·投票券」數量，票數較高的一方獲勝。

        ◇ 積分奪取：勝利方可奪取失敗方的對決積分，積分高低直接影響獎勵豐富程度。

        ◇ 家園對決等級：參與對決可獲得家園對決積分，用於提升玩家的家園對決等級，等級越高，最終獎勵越豐富。

        **☆ 家園·投票券獲得方式**

        ◇ 任務獲取：可透過完成指定任務獲得家園·投票券。

        ◇ 贈送禮物：向其他玩家贈送家園禮物也可以增加自己的家園·投票券。

        ◇ 注意：一般人氣禮物不會增加「家園·投票券」數量，只有活動指定的家園禮物才有效。

        ◇ 有效時間：只有在評選期內每輪對決期間贈送的家園禮物才會計入投票券，非對決期間贈送的禮物則不納入統計。

        **家園風格評選**

        **☆ 活動主題：參與家園風格評選！參選抽現金，投票拿獎勵，下一個設計大師就是你！**

        **☆ 活動時間**

        ◇ 風格評選開啟時間：6/9/2025 00:00:00至30/10/2025 08:59:59（UTC+0）

        ◇ 現金抽獎結果公告時間：23/10/2025 00:00:00至28/10/2025 08:59:59（UTC+0）

        **☆ 參與條件與規則**

        ◇ 報名：報名家園建造大賽後，將開啟特定主題的風格評選活動。

        ◇ 風格分要求：活動期間，玩家的家園對應風格分滿足要求即可參與評選。

        ◇ 推薦與提名：進入建構對決期後，系統會將玩家的家園推薦給其他玩家，並獲得玩家提名。提早報名，對應風格分較高的家園將會更快獲得推薦，並獲得更高曝光。

        ◇ 最低分數限制：若玩家的家園風格分低於最低要求，則會暫時取消推薦資格，直到風格分再次符合要求為止。但已獲得的票數不會受到影響。

        **☆ 獎勵與任務機制**

        ◇ 排名獎勵：活動結束時，系統將根據玩家在這次活動中的總得票數排名，並發放對應的排名獎勵。

        ◇ 提名任務：評選期間，玩家可在活動介面中進行提名操作，完成指定的提名次數任務後即可領取相應獎勵。

        ◇ 現金抽獎：

        \- 評選期間,將開放現金抽獎資格取得任務,完成任務後即可獲得參與最終現金抽獎的資格。抽獎結果將於評選期結束後進行公告。

        \- 防騙提示:中獎後,官方工作人員將透過系統電郵聯絡得獎玩家。請勿輕信任何電郵以外的中獎訊息通知,慎防詐騙。

        **【系統更新】**

        **系統功能改良**

        **☆ 主題系統改版：**

        ◇ 首頁全面升級：新增更直覺的首頁介面，可以快速掌握主題版本更新帶來的全部優質內容，提升資訊取得效率。

        ◇ 玩法介紹調整：與地點相關的玩法元素現在會以圖示形式直接顯示在Erangel地圖上，可更便捷地了解新玩法的具體位置。

        ◇ 任務系統新增：專門的任務介面登場，透過完成任務能獲得主題玩法中的型格外觀道具。

        ◇ 商店功能改良：商店新增分類功能，特別把收藏品解鎖權收納到獨立分頁中，方便查找和瀏覽。

        **☆ 回歸系統調整：**

        ◇ 專屬聊天頻道：為回歸玩家新增專屬聊天頻道，方便回歸玩家之間交流與互動。

        ◇ 組隊任務獎勵：回歸任務新增與組隊次數相關的額外獎勵。

        ◇ 加分卡功能：新增可分享的加分卡，回歸玩家在每日對局中可以獲得並分享給好友使用。

        **☆ 特訓營地：**

        ◇ 等級要求降低：特訓營地的參與等級要求降低至3級即可顯示。

        ◇ 評分標籤調整：改善玩家評分及玩家標籤展示，方便查看其他玩家的老兵好感度。

        ◇ 邀請功能升級：新增加好友和一鍵邀請功能，改善邀請流程，讓組隊更加便捷。

        ◇ 地圖覆蓋範圍擴展：覆蓋地圖擴展至Erangel和Livik的每期主題玩法，並且支援全選操作。

        **☆ 老兵營地：**

        ◇ 獎勵展示改善：單局獎勵增加顯示功能，獎勵數量範圍更清晰。

        ◇ 好評機制調整：特訓好評次數從原本的過往累積記錄改為每週更新。

        ◇ 等級獎勵升級：老兵等級獎勵升級，玩家升級後可以獲得更多獎勵。

        ◇ 地圖覆蓋與選擇：覆蓋地圖同樣擴展至Erangel和Livik的每期主題玩法，並允許玩家全選。

        **☆ 倉庫更新**

        ◇ 新增隨機穿搭功能，點擊後可於預設範圍內隨機擇一套配搭穿著。

        ◇ 新增每日隨機穿著功能，剔選後，每日首次登入時會在預設範圍內隨機穿著一套配搭。

        ◇ 開放節奏：為保障功能穩定，隨機配搭功能將分批逐步開放，初期優先小範圍測試，隨後逐步擴大覆蓋範圍。預計9月9日完成全面開放，具體時間可能根據實際情況動態調整。

        **☆ 公會更新**

        ◇ 公告功能調整：雲團公告輸入上限大幅擴充，改善公告展示效果，提升閱讀體驗。

        ◇ 明星系統調整：公會明星任命時提供多種篩選方式，並支援對成員名稱的模糊搜尋，幫助管理者更快定位「明星玩家」。改善展示效果，解決視角兼容度和載入模糊問題。

        ◇ 訊息置頂功能：新增公會訊息置頂功能，公會管理者可以選擇若干條公會頻道中的聊天內容置頂。

        ◇ 頁面公會戰回歸：參與活動可獲得豐富獎勵。

        \- 第一輪報名時間：6/9/2025 00:00:00-11/9/2025 23:59:59（UTC+0）

        \- 第二輪報名時間：4/10/2025 00:00:00-9/10/2025 23:59:59（UTC+0）

        **人氣對決及親密派對**

        **人氣對決活動：**

        ☆ 報名時間：3/9/2025 00:00:00-9/9/2025 08:59:59（UTC+0）

        ☆ 對決時間：9/9/2025 09:00:00-9/10/2025 09:00:00（UTC+0）

        ☆ 活動規則：

        ◇ 參賽門檻：等級≥2且人氣等級≥2

        ◇ 報名：若錯過報名期，對決期間仍可報名。報名後將進入下一輪的配對池。

        ◇ 配對：共10輪對決，每3天配對實力相當的對手進行1v1人氣對決

        ◇ 對決：對決期間，比較雙方的人氣值獲取情況。人氣值較高的一方將獲得勝利。獲勝方可奪取失敗方的對決積分，比例為50%

        ◇ 積分：對決積分=基礎積分+奪取積分。獲得人氣值越高，基礎積分越多。失敗方人氣值越高，獲勝方可奪取的積分越多。

        ◇ 參與對決可贏取對決積分，進而提升對決等級。對決等級越高，獲得的獎勵越稀有。

        ◇ 活動期間，連續贏得2輪對決進入連勝狀態，失敗則立即終止連勝。對決平手不會結束連勝狀態，也不會增加最大連勝次數。將按照今期對決最高連勝次數領取獎勵。

        ◇ 人氣對決獎勵全面升級，新增可升級獎勵資源，包括動態名片/動態資訊卡/社交資料背景圖，解鎖可升級更多動感效果！

        ◇ 人氣水晶：活動期間透過連勝獎勵和人氣兌換商店獲得，用於升級獎勵資源。

        **☆ 親密派對：**

        ◇ 活動期間完成新增好友、組隊等任務，可獲得親密度道具及限時套裝。

        ◇ 活動時間： 9/9/2025 09:00:00-22/9/2025 23:59:59（UTC+0）

        **☆ 親密度加成活動：**

        ◇ 活動期間，好友之間贈送禮物，親密度可獲得額外加成；累計獲得加成親密度達至一定等級即可領取獎勵。

        ◇ 活動時間： 9/9/2025 09:00:00-22/9/2025 23:59:59（UTC+0）

        **【安全相關】**

        **帳戶安全**

        **☆ 掃瞄二維碼登入調整**

        ◇ 登出選項調整：掃描二維碼登入後，在登出時新增兩個選項：

        \- &lt;登出&gt;：選擇此項將刪除目前掃描二維碼登入的狀態。

        \- &lt;切換&gt;：選擇此項將保留目前掃描二維碼登入的狀態。

        ◇ 登入方式選擇：玩家可在登入介面自由選擇自己想要的登入方式。

        **☆ 安全提示調整**

        ◇ 風險提示升級：改善帳號安全風險提示系統，現在會更清晰向帳號主人呈現帳號風險訊息，幫助玩家：

        \- 更早發現潛在風險

        \- 提前進行風險干預

        \- 有效規避安全風險

        **舉報系統**

        **☆ 改善戰鬥內舉報**

        ◇ 語音違規處理：舉報語音違規時，新增一鍵封鎖功能，可立即封鎖被舉報對象的語音。

        **☆ 改善大廳舉報**

        ◇ 語言類違規處理：舉報語言類違規時，新增一鍵加入黑名單功能，可立即把被舉報對象加入黑名單。

        **☆ 改善舉報回覆**

        ◇ 戰鬥中回覆：如果玩家在戰鬥中收到舉報成功的回覆，可以在訊息欄查看舉報成功的簡要訊息。

        **安全策略**

        ☆ 安全偵測系統升級，提升針對透視、自動瞄準、子彈追蹤、無後坐力、加速、竄改資源檔案、造型美化、除草等外掛的偵測能力。

        ☆ 違規行為偵測升級。提升對惡意組隊、惡意卡配對、加入外掛隊伍等違規行為的偵測能力。

        ☆ 加強對遊戲內不法產業小帳號、交易、護航、機械人程式、刷人氣、不法產業退款等利用違規手段獲利行為的偵測和管控程度，遵守遊戲規則，提升玩家遊戲體驗。

        ☆ 內容安全偵測升級：提升對發言、頭像、語音、家園場景的偵測能力和處罰程度，規管遊戲行為。

        感謝大家一直以來的支持與厚愛！如對新版本有任何意見反映，歡迎隨時聯絡我們，期待與你攜手共創更精彩的戰場體驗！

        PUBG MOBILE營運團隊

        2025年9月3日
        """

        # 4. 调用特征提取接口
        print("\n" + "=" * 50)
        print("开始提取文章特征...")
        extract_result = client.extract_style(article_text=test_article)

        # 5. 打印提取结果（按需解析字段）
        print("\n文章特征提取结果：")
        print(f"状态码：{extract_result['ret_code']}")
        print(f"风格概括：{extract_result['style_summary']}")
        print(f"风格标签：{extract_result['style_label']}")
        print(f"多维度风格特征：{json.dumps(extract_result['style'], indent=2, ensure_ascii=False)}")
        print(f"事实信息：{extract_result['fact_info']}")
        print(f"图片链接：{extract_result['image'] or '无'}")
        print(f"写作思维链（CoT）：{extract_result['CoT']}")
        print(f"写作提示词：{extract_result['prompt']}")

    except (ValueError, RequestException) as e:
        # 捕获并打印所有异常
        print("\n" + "=" * 50)
        print(f"调用失败：{str(e)}")